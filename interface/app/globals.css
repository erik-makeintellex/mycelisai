@import "tailwindcss";
@import "leaflet/dist/leaflet.css";

@theme {
  --font-sans: var(--font-ui), "Segoe UI", ui-sans-serif, system-ui, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";
  --font-mono: var(--font-code), ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;

  /* Cortex Palette — Midnight (Lifted Contrast) */
  --color-cortex-bg: #111821;
  --color-cortex-surface: #1a2430;
  --color-cortex-primary: #1ab4cf;
  /* cyan-500 */
  --color-cortex-primary-glow: rgba(26, 180, 207, 0.39);
  --color-cortex-success: #23b26f;
  /* emerald-500 */
  --color-cortex-warning: #e6a63d;
  /* amber-500 */
  --color-cortex-danger: #df5d5d;
  /* red-500 */
  --color-cortex-info: #4f8ef7;
  /* blue-500 */
  --color-cortex-text-main: #e8eff7;
  --color-cortex-text-muted: #9fb0c2;
  --color-cortex-border: #324353;
}

@layer base {
  /* Cortex readability: bump base from 16px to 17px so all rem-based
     Tailwind classes scale up proportionally. text-xs → 12.75px,
     text-sm → 14.875px, text-base → 17px. */
  html {
    font-size: 17px;
  }

  body {
    background-color: var(--color-cortex-bg);
    color: var(--color-cortex-text-main);
    font-family: var(--font-sans);
    line-height: 1.55;
    text-rendering: optimizeLegibility;
    font-feature-settings: "kern" 1, "liga" 1;
    -webkit-font-smoothing: antialiased;
  }

  h1, h2, h3, h4, h5, h6 {
    color: var(--color-cortex-text-main);
    line-height: 1.25;
    letter-spacing: -0.01em;
  }

  p, li {
    line-height: 1.58;
  }

  code, pre, kbd, samp {
    font-family: var(--font-mono);
  }
}

@layer components {

  /* Cortex Card */
  .cortex-card {
    @apply rounded-xl border shadow-sm transition-shadow duration-200 hover:shadow-md;
    background-color: var(--color-cortex-surface);
    border-color: var(--color-cortex-border);
  }

  /* Cortex Panel (Sidebar/Header) */
  .cortex-panel {
    background-color: var(--color-cortex-surface);
    border-color: var(--color-cortex-border);
  }

  /* Glass Morphism */
  .glass {
    @apply backdrop-blur-md border;
    background-color: rgba(26, 36, 48, 0.78);
    border-color: var(--color-cortex-border);
  }

  /* Glow Utilities */
  .glow-stable {
    box-shadow: 0 0 12px rgba(16, 185, 129, 0.3);
  }

  .glow-active {
    box-shadow: 0 0 12px rgba(6, 182, 212, 0.3);
  }

  .glow-critical {
    box-shadow: 0 0 12px rgba(234, 84, 85, 0.3);
  }

  .glow-primary {
    box-shadow: 0 4px 14px 0 var(--color-cortex-primary-glow);
  }

  /* Active nav pill */
  .nav-pill-active {
    @apply rounded-lg text-cortex-bg;
    background-color: var(--color-cortex-primary);
    box-shadow: 0 4px 14px 0 var(--color-cortex-primary-glow);
  }

  /* Ghost Draft Nodes — Symbiote "thinking" state */
  .ghost-draft {
    animation: pulse-border 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
  }

  .react-flow__node.ghost-draft>div {
    opacity: 0.5;
    border-style: dashed;
    border-color: rgba(6, 182, 212, 0.4);
  }

  /* Observable Plot — Dark Overrides */
  .chart-container figure[aria-label] {
    color: var(--color-cortex-text-main);
    background: transparent;
  }

  .chart-container figure[aria-label] text {
    fill: var(--color-cortex-text-muted);
  }

  .chart-container figure[aria-label] line,
  .chart-container figure[aria-label] .tick line {
    stroke: var(--color-cortex-border);
  }

  .chart-container figure[aria-label] .domain {
    stroke: var(--color-cortex-border);
  }

  /* Leaflet — Dark Overrides */
  .leaflet-container {
    background-color: var(--color-cortex-surface);
  }

  .leaflet-control-zoom a {
    background-color: var(--color-cortex-surface) !important;
    color: var(--color-cortex-text-main) !important;
    border-color: var(--color-cortex-border) !important;
  }

  .leaflet-popup-content-wrapper,
  .leaflet-popup-tip {
    background-color: var(--color-cortex-surface);
    color: var(--color-cortex-text-main);
  }
}

@keyframes pulse-border {

  0%,
  100% {
    border-color: rgba(6, 182, 212, 0.4);
  }

  50% {
    border-color: rgba(6, 182, 212, 1);
    box-shadow: 0 0 15px rgba(6, 182, 212, 0.5);
  }
}

/* Override ReactFlow's default canvas background */
.react-flow {
  background-color: var(--color-cortex-bg) !important;
}

/* Agent Activity Ring — orbiting glow when agent is "thinking" */
.activity-ring {
  animation: ring-pulse 1.5s ease-in-out infinite;
}

@keyframes ring-pulse {

  0%,
  100% {
    border-color: rgba(6, 182, 212, 0.3);
    box-shadow: 0 0 0 rgba(6, 182, 212, 0);
  }

  50% {
    border-color: rgba(6, 182, 212, 0.8);
    box-shadow: 0 0 16px rgba(6, 182, 212, 0.35);
  }
}

/* Deliverables Tray — subtle pulse to signal pending human action */
.animate-pulse-subtle {
  animation: pulse-subtle 3s ease-in-out infinite;
}

@keyframes pulse-subtle {

  0%,
  100% {
    box-shadow: 0 4px 20px rgba(16, 185, 129, 0.08);
  }

  50% {
    box-shadow: 0 4px 24px rgba(16, 185, 129, 0.2);
  }
}
