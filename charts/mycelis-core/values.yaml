replicaCount: 1

image:
  repository: mycelis/core
  tag: latest
  pullPolicy: IfNotPresent

service:
  type: ClusterIP
  port: 8080

resources:
  requests:
    cpu: 50m
    memory: 64Mi
  limits:
    cpu: 200m
    memory: 256Mi

podSecurityContext:
  runAsUser: 10001
  runAsGroup: 10001
  fsGroup: 10001
  runAsNonRoot: true
  seccompProfile:
    type: RuntimeDefault

securityContext:
  allowPrivilegeEscalation: false
  readOnlyRootFilesystem: true
  capabilities:
    drop: ["ALL"]

env:
  - name: NATS_URL
    value: "nats://mycelis-core-nats:4222"
  - name: DB_HOST
    value: "mycelis-core-postgresql"
  - name: DB_USER
    value: "mycelis"
  - name: DB_PASSWORD
    value: "password"
  - name: DB_NAME
    value: "cortex"

# NATS JetStream Configuration
nats:
  enabled: true
  config:
    jetstream:
      enabled: true
      max_memory_store: 128Mi
      max_file_store: 2Gi # Event Store Limit
      store_dir: /data/jetstream
  jetstream:
    enabled: true
    fileStore:
      pvc:
        enabled: true
        size: 5Gi
        storageClassName: standard
  securityContext:
    runAsNonRoot: true
    runAsUser: 1001
    fsGroup: 1001
    allowPrivilegeEscalation: false
    capabilities:
      drop: ["ALL"]

# PostgreSQL Configuration (Bitnami)
# PostgreSQL Configuration (Bitnami)
postgresql:
  enabled: true
  image:
    tag: "16.1.0-debian-11-r12"
  auth:
    postgresPassword: "password"
    username: "mycelis"
    password: "password"
    database: "cortex"
  primary:
    resources:
      requests:
        cpu: 100m
        memory: 256Mi
      limits:
        cpu: 500m
        memory: 512Mi
    persistence:
      enabled: true
      size: 1Gi
